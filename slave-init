#cloud-config
  disable_root: false
  resize_rootfs_tmp: /dev
  users:
    - default
    - name: marek-ubu
      groups: sudo
      shell: /bin/bash
      sudo: ['ALL=(ALL) NOPASSWD:ALL']
      ssh_authorized_keys:
        - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDC5fQwh4xwlf820fkr8hmRe7CNjglCTMSrIv8CKrbpSUJJFjSvb+lGvnwUFgG+gBRB0RMt3N/IyyCphqtDIAHhrXkX5HqXYQZpfXcOqfD4+3nTCs5TniOM4rKBFfbMdFHf7lfXc2bbOyNGw5Th70ooXuq8J9PPhKig2Gn4ClXIZ5fgZC4pe07L/l9rv4J3nYgVgcbB9LG/SXx3wkUoIjupPEhRvfW4+zUuPTJiUV/+cKgBgYewdBQnPTctQpex2rTC4WFww7VM4/6G4oeY1PrSzvykQs214Qc8Nnqky/fGpOYoWSmrGevS3It8FdBxxhBOLd66UOATF6ypp2CjrOscPYy+c0X0D3+bqUc2v/kPnAF+TgqRNCG+M3g+fmnAFheIAz459Fo+ulbOFRCgTpEhDZxthVT5LXl/uajYAYaaED7JS4L2+CEVWQu551UKNxKMt2isA/3yGwZi9ShUkaU1GZj1QuqCyf92Hn8Qax79+3iyY7iGiUoh0Bt/J/dy9FM= marek-ubu@marekubu-XPS-13-9310
  runcmd:
    - apt update
    - apt install -y openjdk-8-jre-headless
    - mkdir /opt/hadoop
    - mkdir /opt/config_files
    - wget -P /opt/hadoop https://dlcdn.apache.org/hadoop/common/hadoop-2.10.1/hadoop-2.10.1.tar.gz
    - tar xvzf /opt/hadoop/hadoop-2.10.1.tar.gz -C /opt/hadoop
    - sed -i 's/export\sJAVA_HOME=\${JAVA_HOME}/export JAVA_HOME=\/usr\/lib\/jvm\/java-8-openjdk-amd64/' /opt/hadoop/hadoop-2.10.1/etc/hadoop/hadoop-env.sh
    - git clone https://github.com/kraumar/slave-node-spark.git /opt/config_files
    - mv /opt/config_files/core-site.xml /opt/hadoop/hadoop-2.10.1/etc/hadoop/core-site.xml
    - mv /opt/config_files/hdfs-site.xml /opt/hadoop/hadoop-2.10.1/etc/hadoop/hdfs-site.xml
    - mkdir -p /usr/local/hadoop/hdfs/data
    - chown -R 'marek-ubu:' /opt
    - chown -R 'marek-ubu:marek-ubu' /usr/local/hadoop/hdfs/data
  final_message: 'Hadoop Slave is up'
